<div class="whatsapp-search-member-layout">
  <!-- Sidebar -->
  <app-sidebar></app-sidebar>

  <!-- Main Content -->
  <div class="main-content">
    <div class="search-member-page">
      <div class="page-header">
        <div class="breadcrumb">
          <span>Dashboard</span>
          <span class="breadcrumb-sep">•</span>
          <span>Whatsapp Member</span>
          <span class="breadcrumb-sep">•</span>
          <span class="breadcrumb-current">Search</span>
        </div>
        <h1>Search member details</h1>
      </div>
<!-- SEARCH -->
<div class="search-bar">
  <input
    type="text"
    placeholder="Search by member name, number or group…"
    [(ngModel)]="searchTerm"
    (input)="onSearch()"     
  />
</div>

<!-- TABLE -->
<div class="table-container" *ngIf="!isLoading">
  <table class="members-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Member Name</th>
        <th>Number</th>
        <th>Group</th>
        <th>Created By</th>
        <th>Status</th>
        <th>Created At</th>
        <th>Action</th>
      </tr>
    </thead>

    <tbody>
      <!-- ✅ use the paginated slice -->
      <tr *ngFor="let m of paginatedMembers">
        <td><span class="id-badge">#{{ m.member_id }}</span></td>
        <td>{{ m.member_name }}</td>
        <td>{{ m.member_number }}</td>
        <td>{{ m.group_name }}</td>
        <td>{{ m.created_by }}</td>
        <td>
          <span class="status-badge" [class.active]="m.status === 'ACTIVE'">
            {{ m.status }}
          </span>
        </td>
        <td>{{ formatDate(m.created_at) }}</td>
     <td class="position-relative">
  <!-- 3-dot Action Button -->
  <button class="actions-button" (click)="toggleActionMenu(m.member_id)">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="1" />
      <circle cx="12" cy="5" r="1" />
      <circle cx="12" cy="19" r="1" />
    </svg>
  </button>

  <!-- Action Menu (shown only if activeActionMemberId matches) -->
  <div class="action-menu" *ngIf="activeActionMemberId === m.member_id">
    <button (click)="deleteMember(m.member_id)" class="delete-btn">
      <svg xmlns="http://www.w3.org/2000/svg" class="delete-icon" width="16" height="16" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
        viewBox="0 0 24 24">
        <polyline points="3 6 5 6 21 6" />
        <path
          d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
        <line x1="10" y1="11" x2="10" y2="17" />
        <line x1="14" y1="11" x2="14" y2="17" />
      </svg>
      Delete
    </button>
    <button class="retry-btn" (click)="deleteMemberFromAllGroups(m)">
      <svg xmlns="http://www.w3.org/2000/svg" class="delete-icon" width="16" height="16" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
        viewBox="0 0 24 24">
        <polyline points="3 6 5 6 21 6" />
        <path
          d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
        <line x1="10" y1="11" x2="10" y2="17" />
        <line x1="14" y1="11" x2="14" y2="17" />
      </svg>
      Delete All
    </button>
  </div>
</td>

      </tr>

      <!-- show only when filtered list is empty -->
      <tr *ngIf="filteredMembers.length === 0">
        <td colspan="7" class="no-data">No members found</td>
      </tr>
    </tbody>
  </table>

  <!-- PAGINATION (unchanged markup) -->
  <div class="pagination" *ngIf="totalPages > 1">
    <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">
      ‹ Prev
    </button>

    <button
      *ngFor="let pg of [].constructor(totalPages); let i = index"
      (click)="changePage(i + 1)"
      [class.active]="currentPage === i + 1"
    >
      {{ i + 1 }}
    </button>

    <button
      (click)="changePage(currentPage + 1)"
      [disabled]="currentPage === totalPages"
    >
      Next ›
    </button>
  </div>
</div>

  
    </div>
  </div>
</div>
